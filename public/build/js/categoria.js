function iniciarApp(){consultarAPI()}async function consultarAPI(){const t=await fetch("http://localhost:3000/api/categoria");mostrarTabla(await t.json())}function mostrarTabla(t){$("#myTable").DataTable().clear().destroy();let a="";t.forEach(t=>{t.id=null==t.id?"":t.id,t.descripcion=null==t.descripcion?"":t.descripcion;var o=` data-id="${t.id}"   \n                            data-descripcion="${t.descripcion}"\n        `;a+="  <tr>",a+="      <td>",a+='          <div class="dropdown">',a+='             <button class="btn btn-primary btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">',a+='              \tAcciones <span class="caret"></span>',a+="             </button>",a+='             <ul class="dropdown-menu">',a+=`               <li><a href="#" class="dropdown-item" id="button_accion" data-opcion="ver" ${o}>Ver</a></li>`,a+=`\t\t\t\t        <li><a href="#" class="dropdown-item" id="button_accion" data-opcion="editar" ${o}>Editar</a></li>`,a+='               <li><a href="#" class="dropdown-item" id="button_accion" data-opcion="eliminar" data-id="'+t.id+'">Eliminar</a></li>',a+="             </ul>",a+="           </div>",a+="      </td>",a+=`      <td>${t.descripcion}</td>`,a+="  </tr>"}),$("#myTable tbody").html(a),$("#myTable").DataTable()}function get_tag(t){return{id:$(t).data("id"),descripcion:$(t).data("descripcion")}}document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));const form=document.querySelector("#form_categoria");function limpiarFormulario(t){t.querySelectorAll("input").forEach(t=>{t.value=""})}async function crear_categoria(){const t=$("#descripcion").val(),a=new FormData;a.append("descripcion",t);const o=await fetch("http://localhost:3000/api/crear-categoria",{method:"POST",body:a});!0===(await o.json()).resultado?($.confirm({theme:"black",title:"Exito!",content:"Categoria agregada correctamente",type:"blue",typeAnimated:!0,buttons:{tryAgain:{text:"OK",btnClass:"btn-blue",close:function(){}}}}),limpiarFormulario(form),consultarAPI()):$.confirm({theme:"black",title:"Error!",content:"Algo salió mal, intentalo mas tarde",type:"red",typeAnimated:!0,buttons:{tryAgain:{text:"OK",btnClass:"btn-red",close:function(){}}}})}async function actualizar_categoria(t){descripcion=$("#descripcion").val();const a=await fetch("http://localhost:3000/api/actualizar_categoria",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,descripcion:descripcion})});!0===await a.json()?($.confirm({theme:"black",title:"Exito!",content:"La categoría se ha actualizado correctamente",type:"blue",typeAnimated:!0,buttons:{tryAgain:{text:"OK",btnClass:"btn-blue",close:function(){}}}}),consultarAPI()):$.confirm({theme:"black",title:"Error!",content:"Algo salió mal, intentalo mas tarde",type:"red",typeAnimated:!0,buttons:{tryAgain:{text:"OK",btnClass:"btn-red",close:function(){}}}})}async function eliminar_categoria(t){const a=await fetch("http://localhost:3000/api/eliminar-categoria",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})}),o=await a.json();$("#modalSheet").modal("hide"),!0===o?($.confirm({theme:"black",title:"Exito!",content:"La categoría se ha eliminado correctamente",type:"blue",typeAnimated:!0,buttons:{tryAgain:{text:"OK",btnClass:"btn-blue",close:function(){}}}}),consultarAPI()):$.confirm({theme:"black",title:"Error!",content:"Algo salió mal, intentalo mas tarde.",type:"red",typeAnimated:!0,buttons:{tryAgain:{text:"OK",btnClass:"btn-red",close:function(){}}}})}$(document).on("click","#button_accion",(function(){var t=$(this).data("opcion"),a=get_tag(this),o=a.id,e=a.descripcion;switch(t){case"crear":$("#modal-title").text("Crear categoría"),$("#modal_action_button").text("Crear"),$("#modalCategoria").modal("show"),limpiarFormulario(form);break;case"editar":$("#descripcion").val(e),$("#modal-title").text("Actualizar categoría"),$("#modal_action_button").text("Actualizar"),$("#modal_action_button").data("id",a.id),$("#modalCategoria").modal("show");break;case"ver":$("#descripcion").val(e),$("#descripcion").prop("disabled",!0),$("#modal-title").text("Ver categoría"),$("#modal_action_button").hide(),$("#modalCategoria").modal("show");break;case"eliminar":$("#modal_action_button").data("id",o),$("#modalSheet").modal("show")}})),$("#modalCategoria").on("hidden.bs.modal",(function(){$("#descripcion").prop("disabled",!1),$("#modal_action_button").show(),form.classList.remove("was-validated")})),$(document).on("click","#modal_action_button",(function(t){var a=$(this).text(),o=$("#modal_action_button").data("id");const e=document.querySelector(".needs-validation");switch(a){case"Crear":if(!e.checkValidity())return t.preventDefault(),t.stopPropagation(),void e.classList.add("was-validated");crear_categoria();break;case"Actualizar":if(!e.checkValidity())return t.preventDefault(),t.stopPropagation(),void e.classList.add("was-validated");actualizar_categoria(o);break;case"Eliminar":eliminar_categoria(o)}}));