function iniciarApp(){consultarAPI()}async function consultarAPI(){const a=await fetch("http://localhost:3000/api/marca");mostrarTabla(await a.json())}function mostrarTabla(a){$("#myTable").DataTable().clear().destroy();let t="";a.forEach(a=>{a.id=null==a.id?"":a.id,a.descripcion=null==a.descripcion?"":a.descripcion;var o=` data-id="${a.id}"   \n                            data-descripcion="${a.descripcion}"\n        `;t+="  <tr>",t+="      <td>",t+='          <div class="dropdown">',t+='             <button class="btn btn-primary btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">',t+='              \tAcciones <span class="caret"></span>',t+="             </button>",t+='             <ul class="dropdown-menu">',t+=`               <li><a href="#" class="dropdown-item" id="button_accion" data-opcion="ver" ${o}>Ver</a></li>`,t+=`\t\t\t\t        <li><a href="#" class="dropdown-item" id="button_accion" data-opcion="editar" ${o}>Editar</a></li>`,t+='               <li><a href="#" class="dropdown-item" id="button_accion" data-opcion="eliminar" data-id="'+a.id+'">Eliminar</a></li>',t+="             </ul>",t+="           </div>",t+="      </td>",t+=`      <td>${a.descripcion}</td>`,t+="  </tr>"}),$("#myTable tbody").html(t),$("#myTable").DataTable()}function get_tag(a){return{id:$(a).data("id"),descripcion:$(a).data("descripcion")}}document.addEventListener("DOMContentLoaded",(function(){iniciarApp()}));const form=document.querySelector("#form_marca");function limpiarFormulario(a){a.querySelectorAll("input").forEach(a=>{a.value=""})}async function crear_marca(){const a=$("#descripcion").val(),t=new FormData;t.append("descripcion",a);const o=await fetch("http://localhost:3000/api/crear-marca",{method:"POST",body:t});!0===(await o.json()).resultado?($("#modalMarca").modal("hide"),$.confirm({theme:"black",title:"Exito!",content:"Marca agregada correctamente",type:"blue",typeAnimated:!0,buttons:{tryAgain:{text:"OK",btnClass:"btn-blue",close:function(){}}}}),limpiarFormulario(form),consultarAPI()):$.confirm({theme:"black",title:"Error!",content:"Algo salió mal, intentalo mas tarde",type:"red",typeAnimated:!0,buttons:{tryAgain:{text:"OK",btnClass:"btn-red",close:function(){}}}})}async function actualizar_marca(a){descripcion=$("#descripcion").val();const t=await fetch("http://localhost:3000/api/actualizar-marca",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a,descripcion:descripcion})});!0===await t.json()?($("#modalMarca").modal("hide"),$.confirm({theme:"black",title:"Exito!",content:"La marca se ha actualizado correctamente",type:"blue",typeAnimated:!0,buttons:{tryAgain:{text:"OK",btnClass:"btn-blue",close:function(){}}}}),consultarAPI()):$.confirm({theme:"black",title:"Error!",content:"Algo salió mal, intentalo mas tarde",type:"red",typeAnimated:!0,buttons:{tryAgain:{text:"OK",btnClass:"btn-red",close:function(){}}}})}async function eliminar_marca(a){const t=await fetch("http://localhost:3000/api/eliminar-marca",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a})}),o=await t.json();$("#modalSheet").modal("hide"),!0===o?($.confirm({theme:"black",title:"Exito!",content:"La marca se ha eliminado correctamente",type:"blue",typeAnimated:!0,buttons:{tryAgain:{text:"OK",btnClass:"btn-blue",close:function(){}}}}),consultarAPI()):$.confirm({theme:"black",title:"Error!",content:"Algo salió mal, intentalo mas tarde.",type:"red",typeAnimated:!0,buttons:{tryAgain:{text:"OK",btnClass:"btn-red",close:function(){}}}})}$(document).on("click","#button_accion",(function(){var a=$(this).data("opcion"),t=get_tag(this),o=t.id,i=t.descripcion;switch(a){case"crear":$("#modal-title").text("Crear marca"),$("#modal_action_button").text("Crear"),$("#modalMarca").modal("show"),limpiarFormulario(form);break;case"editar":$("#descripcion").val(i),$("#modal-title").text("Actualizar marca"),$("#modal_action_button").text("Actualizar"),$("#modal_action_button").data("id",t.id),$("#modalMarca").modal("show");break;case"ver":$("#descripcion").val(i),$("#descripcion").prop("disabled",!0),$("#modal-title").text("Ver marca"),$("#modal_action_button").hide(),$("#modalMarca").modal("show");break;case"eliminar":$("#modal_action_button").data("id",o),$("#modalSheet").modal("show")}})),$("#modalMarca").on("hidden.bs.modal",(function(){$("#descripcion").prop("disabled",!1),$("#modal_action_button").show(),form.classList.remove("was-validated")})),$(document).on("click","#modal_action_button",(function(a){var t=$(this).text(),o=$("#modal_action_button").data("id");const i=document.querySelector(".needs-validation");switch(t){case"Crear":if(!i.checkValidity())return a.preventDefault(),a.stopPropagation(),void i.classList.add("was-validated");crear_marca();break;case"Actualizar":if(!i.checkValidity())return a.preventDefault(),a.stopPropagation(),void i.classList.add("was-validated");actualizar_marca(o);break;case"Eliminar":eliminar_marca(o)}}));